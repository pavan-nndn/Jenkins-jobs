pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                script {
                    echo 'starting the build state'
                    sh 'pwd'
                     //Map servers = readJSON file: serverConfig
                     //sshagent(credentials: ["guxgit1"]) {
                     //echo 'ssh is working'
                     //sh 'ssh -i'
                     //}
                     //echo servers
                     
                     configFileProvider(
                            [configFile(fileId: 'serverConfig', variable: 'serverConfig')]) {
                             echo '$serverConfig'
                             def servers = readJSON file: serverConfig
                             def dispatcherServer = servers[selEnv]['dispatcher'][0]
                             echo "dispatcherServer $dispatcherServer"
                             echo 'ending the build state'
                     }
                }
            }
        }
    }
}
